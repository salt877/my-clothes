<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
<meta charset="utf-8" />
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta name="description" content="" />
<meta name="author" content="" />
<title>MYQLO | Weather</title>
<link rel="icon" type="image/x-icon"
	href="../static/dist/assets/img/myqlo_favicon.jpg"
	th:href="@{/dist/assets/img/myqlo_favicon.jpg}" />
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script
	src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
<script src='https://use.fontawesome.com/releases/v5.0.13/js/all.js'></script>

<!-- Font Awesome icons (free version)-->
<script src="https://use.fontawesome.com/releases/v5.13.0/js/all.js"
	crossorigin="anonymous"></script>
<!-- Google fonts-->
<link href="https://fonts.googleapis.com/css?family=Montserrat:400,700"
	rel="stylesheet" type="text/css" />
<link
	href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic"
	rel="stylesheet" type="text/css" />
<link
	href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700"
	rel="stylesheet" type="text/css" />
<!-- Core theme CSS (includes Bootstrap)-->
<link href="../static/dist/css/styles.css" rel="stylesheet"
	th:href="@{/dist/css/styles.css}" />
<link href="../static/dist/css/weather.css" rel="stylesheet"
	th:href="@{/dist/css/weather.css}" />
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script type="text/javascript" src="../static/dist/js/weather.js"
	th:src="@{/dist/js/weather.js}" /></script>
<style type="text/css">
//body {
//	background-image: url(../img/weather.jpg);
//	background-color: rgba(255, 255, 255, 0.8);
//	background-blend-mode: lighten;
//}


</style>


<script type="text/javascript">
	$(function() {
		var API_KEY = '478ea780a9d4d20c8ddf7539de30ee32';
		const str = document.getElementById("city").value;
		console.log(str);
		var city = str;
		var url = 'http://api.openweathermap.org/data/2.5/forecast?q=' + city
				+ ',jp&units=metric&APPID=' + API_KEY;
		$.ajax({
			url : url,
			dataType : "json",
			type : 'GET',
		}).done(function(data) {
			console.log(data)
			var insertHTML = "";
			var cityName = '<h2>' + data.city.name + '</h2>';
			$('#city-name').html(cityName);
			for (var i = 0; i <= 18; i = i + 4) {
				insertHTML += buildHTML(data, i);
			}
			$('#weather').html(insertHTML);
		}).fail(function(data) {
			console.log("失敗しました");
		});
	});

	function buildHTML(data, i) {
		var Week = new Array("（日）", "（月）", "（火）", "（水）", "（木）", "（金）", "（土）");
		var date = new Date(data.list[i].dt_txt);
		date.setHours(date.getHours() + 9);
		var month = date.getMonth() + 1;
		var day = month + "月" + date.getDate() + "日" + Week[date.getDay()]
				+ date.getHours() + "：00";
		var icon = data.list[i].weather[0].icon;
		var html = '<span class="weather-report">'
				+ '<img src="http://openweathermap.org/img/w/' + icon + '.png">'
				+ '&nbsp;&nbsp;&nbsp;&nbsp;<div class="weather-date">'
				+ day
				+ '&nbsp;&nbsp;&nbsp;&nbsp;</div>'
				+ '<div class="weather-main">' + data.list[i].weather[0].main
				+ '&nbsp;</div>' + '<div class="weather-temp">'
				+ Math.round(data.list[i].main.temp) + '℃</div>' + '</span>';
		return html
	}

	function clickBtn3() {
		const str = document.getElementById("city").value;
		console.log(str);
		//form1.submit();
		var city = str;
		//alert(str+"に設定しました");

	}
</script>
</head>



<body>
	<!-- Navigation-->
	<div id="navArea">
		<nav class="navbar navbar-default" th:replace="header::pageheader"></nav>
	</div>
	<div class="text-center">
		<h1 class="section-heading text-uppercase" style="margin-top: 100px;">MY
			WEATHER</h1>
		<div class="section-subheading text-muted">設定地区の天気予報をチェック。</div>
		<br> <br> <br> <br>
	</div>
	<div align="center">
		<h3 th:text="${pref}+'の天気予報'"></h3>
		<br> <span id="weather"></span>
	</div>
	<br>
	<br>
	<br>
	<br>
	<form action="" th:action="@{/weather/registerCity}" method="post"
		th:object="${weatherForm}" name="form1">
		<div align="center">
			<span style="display: inline-flex"> <br> <select
				id="city" name="city" class="form-control" style="width: 130px"
				onchange="clickBtn3()">
					<optgroup label="北海道　東北">
						<option value="北海道" th:field="*{city}">北海道</option>
						<option value="青森県" th:field="*{city}">青森県</option>
						<option value="岩手県" th:field="*{city}">岩手県</option>
						<option value="宮城県" th:field="*{city}">宮城県</option>
						<option value="秋田県" th:field="*{city}">秋田県</option>
						<option value="山形県" th:field="*{city}">山形県</option>
						<option value="福島県" th:field="*{city}">福島県</option>
					</optgroup>
					<optgroup label="関東">
						<option value="茨城県" th:field="*{city}">茨城県</option>
						<option value="栃木県" th:field="*{city}">栃木県</option>
						<option value="群馬県" th:field="*{city}">群馬県</option>
						<option value="埼玉県" th:field="*{city}">埼玉県</option>
						<option value="千葉県" th:field="*{city}">千葉県</option>
						<option value="東京都" th:field="*{city}">東京都</option>
						<option value="神奈川県" th:field="*{city}">神奈川県</option>
					</optgroup>
					<optgroup label="北陸">
						<option value="新潟県" th:field="*{city}">新潟県</option>
						<option value="富山県" th:field="*{city}">富山県</option>
						<option value="石川県" th:field="*{city}">石川県</option>
						<option value="福井県" th:field="*{city}">福井県</option>
					</optgroup>
					<optgroup label="中部">
						<option value="山梨県" th:field="*{city}">山梨県</option>
						<option value="長野県" th:field="*{city}">長野県</option>
						<option value="岐阜県" th:field="*{city}">岐阜県</option>
						<option value="静岡県" th:field="*{city}">静岡県</option>
						<option value="愛知県" th:field="*{city}">愛知県</option>
						<option value="三重県" th:field="*{city}">三重県</option>
					</optgroup>
					<optgroup label="近畿">
						<option value="滋賀県" th:field="*{city}">滋賀県</option>
						<option value="京都府" th:field="*{city}">京都府</option>
						<option value="大阪府" th:field="*{city}">大阪府</option>
						<option value="兵庫県" th:field="*{city}">兵庫県</option>
						<option value="奈良県" th:field="*{city}">奈良県</option>
						<option value="和歌山県" th:field="*{city}">和歌山県</option>
					</optgroup>
					<optgroup label="中国">
						<option value="鳥取県" th:field="*{city}">鳥取県</option>
						<option value="島根県" th:field="*{city}">島根県</option>
						<option value="岡山県" th:field="*{city}">岡山県</option>
						<option value="広島県" th:field="*{city}">広島県</option>
						<option value="山口県" th:field="*{city}">山口県</option>
					</optgroup>
					<optgroup label="四国">
						<option value="徳島県" th:field="*{city}">徳島県</option>
						<option value="香川県" th:field="*{city}">香川県</option>
						<option value="愛媛県" th:field="*{city}">愛媛県</option>
						<option value="高知県" th:field="*{city}">高知県</option>
					</optgroup>
					<optgroup label="九州　沖縄">
						<option value="福岡県" th:field="*{city}">福岡県</option>
						<option value="佐賀県" th:field="*{city}">佐賀県</option>
						<option value="長崎県" th:field="*{city}">長崎県</option>
						<option value="熊本県" th:field="*{city}">熊本県</option>
						<option value="大分県" th:field="*{city}">大分県</option>
						<option value="宮崎県" th:field="*{city}">宮崎県</option>
						<option value="鹿児島県" th:field="*{city}">鹿児島県</option>
						<option value="沖縄県" th:field="*{city}">沖縄県</option>
					</optgroup>
			</select> &nbsp;&nbsp;&nbsp; <input type="submit" value="都道府県を設定"
				class="btn btn-primary">
			</span>
		</div>
	</form>


	<!-- Footer-->
	<footer class="footer py-4" th:replace="footer::pagefooter"> </footer>


</body>
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script
	src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.bundle.min.js"></script>
<!-- Third party plugin JS-->
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
<!-- Contact form JS-->
<script src="../static/dist/assets/mail/jqBootstrapValidation.js"
	th:src="@{/dist/assets/mail/jqBootstrapValidation.js}"></script>
<script src="../static/dist/assets/mail/contact_me.js"
	th:src="@{/dist/assets/mail/contact_me.js}"></script>
<!-- Core theme JS-->
<script src="../static/dist/js/show_item.js"
	th:src="@{/dist/js/show_item.js}"></script>
<script src="../static/dist/js/scripts.js"
	th:src="@{/dist/js/scripts.js}"></script>
<script src="../static/dist/js/hamburger_menu.js"
	th:src="@{/dist/js/hamburger_menu.js}"></script>
<script src="../static/dist/js/vuemore.js"
	th:src="@{/dist/js/vuemore.js}"></script>
</body>
</html>